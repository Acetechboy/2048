<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="utf-8">
  <title>چلنچ 2048</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="style/main.css" rel="stylesheet" type="text/css">
  <style>
    body {
      text-align: center;
      background: #faf8ef;
      font-family: "Clear Sans", "Helvetica Neue", Arial, sans-serif;
      direction: rtl;
    }
    h1 {
      margin-top: 20px;
      color: #776e65;
    }
    #timer {
      margin-top: 15px;
      font-size: 20px;
      color: #8f7a66;
    }
    #backBtn {
      margin-top: 20px;
      background: #8f7a66;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px 20px;
      cursor: pointer;
      font-size: 16px;
    }
    #backBtn:hover {
      background: #9f8b77;
    }
  </style>
</head>

<body>
  <h1>چلنچ 2048</h1>

  <div class="game-container">
    <div class="game-message">
      <p></p>
      <div class="lower">
        <a class="keep-playing-button">ادامه</a>
        <a class="retry-button">دوباره</a>
      </div>
    </div>

    <div class="grid-container">
      <div class="grid-row">
        <div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div>
      </div>
      <div class="grid-row">
        <div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div>
      </div>
      <div class="grid-row">
        <div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div>
      </div>
      <div class="grid-row">
        <div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div>
      </div>
    </div>

    <div class="tile-container"></div>
  </div>

  <div id="timer">زمان باقی‌مانده: <span id="timeLeft">30:00</span></div>
  <button id="backBtn" onclick="window.location.href='index.html'">بازگشت به منو</button>

  <!-- فایل‌های اصلی بازی 2048 -->
  <script src="js/bind_polyfill.js"></script>
  <script src="js/classlist_polyfill.js"></script>
  <script src="js/animframe_polyfill.js"></script>
  <script src="js/keyboard_input_manager.js"></script>
  <script src="js/html_actuator.js"></script>
  <script src="js/grid.js"></script>
  <script src="js/tile.js"></script>
  <script src="js/local_storage_manager.js"></script>
  <script src="js/game_manager.js"></script>

  <script>
    // اجرای بازی به محض لود صفحه
    window.requestAnimationFrame(function () {
      new GameManager(4, KeyboardInputManager, HTMLActuator, LocalStorageManager);
      startTimer();
    });

    // تایمر چلنج
    let timeLeft = 1800;
    function startTimer() {
      const el = document.getElementById("timeLeft");
      const timer = setInterval(() => {
        if (timeLeft <= 0) {
          clearInterval(timer);
          alert("زمان چلنج تمام شد!");
        } else {
          timeLeft--;
          const m = String(Math.floor(timeLeft / 60)).padStart(2, "0");
          const s = String(timeLeft % 60).padStart(2, "0");
          el.textContent = `${m}:${s}`;
        }
      }, 1000);
    }
  </script>
</body>
</html>
